# Test Profile for Quartz Scheduler Integration Tests
database.type=mysql
database.orm=mybatis

# Use random port for web server to avoid conflicts
server.port=0

# Flyway Configuration - ensure migrations run before Quartz
spring.flyway.enabled=true
spring.flyway.baseline-on-migrate=true
spring.flyway.locations=classpath:db/migration/mysql

# Hibernate configuration - let Flyway handle schema
spring.jpa.hibernate.ddl-auto=none
spring.jpa.generate-ddl=false

# Quartz Configuration for Testing
quartz.enabled=true
quartz.scheduler.instance-name=arcanaScheduler
quartz.scheduler.instance-id=testInstance
quartz.cluster.enabled=false
quartz.thread-pool.size=5
quartz.jobs.auto-register=false

# Spring Boot Quartz Auto-configuration
spring.quartz.job-store-type=jdbc
spring.quartz.jdbc.initialize-schema=never
spring.quartz.wait-for-jobs-to-complete-on-shutdown=true
spring.quartz.overwrite-existing-jobs=true

# Disable JPA for MyBatis tests
spring.autoconfigure.exclude=\
  org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration,\
  org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration,\
  org.springframework.boot.autoconfigure.data.mongo.MongoDataAutoConfiguration,\
  org.springframework.boot.autoconfigure.mongo.MongoAutoConfiguration

# Allow bean overriding for tests
spring.main.allow-bean-definition-overriding=true

# Logging
logging.level.com.arcana.cloud=DEBUG
logging.level.org.quartz=DEBUG

# Disable cloud config
spring.cloud.config.enabled=false

# Disable gRPC server completely
spring.grpc.server.enabled=false
spring.grpc.server.port=-1
grpc.server.port=-1

# Disable caching
spring.cache.type=none

# Deployment mode
deployment.mode=monolithic
